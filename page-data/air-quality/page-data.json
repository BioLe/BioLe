{"componentChunkName":"component---src-templates-works-work-js","path":"/air-quality/","result":{"data":{"site":{"siteMetadata":{"title":"Leonardo Melo"}},"markdownRemark":{"id":"1999003f-e92a-5138-80f5-a5b13104d26b","excerpt":"Architecture  The project is split into four relevant sections: Hardware: a laser dust detection sensor, used for continuos and real-timeâ€¦","rawMarkdownBody":"\r\n# Architecture\r\n\r\n![home](/imgs/iot_arq2.png)\r\n\r\nThe project is split into four relevant sections:\r\n\r\n1. **Hardware**: a laser dust detection sensor, used for continuos and real-time detection of dust in the air was connected to a ESP32 board which includes a GPS sensor.\r\n\r\n2. **Network**: the board communicates with the Low Powered Wide Area Network (LPWAN) **LoRa**, due to its range of 15Km (5km in urban scenarios) and low power consumption. Data from the device is received by the multiple public gateway available in [The Things Network](https://www.thethingsnetwork.org/).\r\n\r\n3. **Backend**: Information is sent from the TTN to our Node-Red backend, where the data is processed and displayed to the user.\r\n\r\n4. **Frontend** a dashboard split into two views generic and detailed.\r\n\r\n# Dashboard\r\n\r\nThe generic dashboard allows the user to:\r\n\r\n- Track the position of all the available devices through the map\r\n- Observe the devices currently deployed and their metadata (Status, Name, Uptime, Position and Battery Level)\r\n- An evolution of the multiple Particle Matters (PM) over the last 28 days (subtracting the average of the last 28 days with the average of the current day)\r\n- The gauges display the Average, Minimum and Maximum values for the PM chosen over the period of days also selected by the user\r\n- Lastly, line graphs that display the average values (Avg, Min, Max) for the last hour for all of the devices\r\n\r\n![home](/imgs/home.png)\r\n\r\nIt is also possible to keep up with the devices individually, allowing us too see:\r\n\r\n- Path taken during operation\r\n- Real time temperature levels\r\n- Device metadata\r\n- Real time measurements of the different particles tracked (PM 1.0, 2.5 and 10)\r\n- All the information received for the particles during the last 24 hours, in 5 minute increments\r\n\r\n![detailed](/imgs/detailed.png)\r\n\r\n# Dashboard updates\r\n\r\nEach dashboard is updated in a different manner. The home dashboard, which includes only aggregated information over multiple days does not require real time information, as such, data is updated through Polling with a periodicity of 1 hour or every time the user refreshes the page.\r\n\r\n![coms](/imgs/coms.png)\r\n\r\nOn the other hand, as the user requires real time information when tracking individual devices a Publish/Subscribe broker was introduced, this way every time new information is received from the gateways a notification is sent to the dashboards and data is updated in realtime.\r\n\r\n![pubsub](/imgs/pubsub.png)\r\n\r\nA subscription was created for the device, that notifies every time something changers such as battery level or location. And a second subscription dedicated to the air quality observed.\r\n","html":"<h1>Architecture</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/LeonardoMelo/static/89f58788be8e2c416677749e0fa4c10e/29229/iot_arq2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.513513513513516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABqklEQVQozz1R227UMBDN//8KCBD8AOKNqg+0aFtRuru5OrEdJ7ZjO06y1WFspD6MZh5mzm2KLUYc+47Uty3mfjt2+DVC+xXheIPbDmy3N+h5gtFzrjV47PuGXjC4YOCjhVstirZtIPgAa3ReTEfO0sJ+Q2tXdFSNCdDrjtVZnB5/4dPHDxh5j3X14LpBKUpU4opuvKKo6xqs66BGCSk4GOsQvMuAjMCE23K32w0LEXZ1iT/PJygS4fwCoa749vCMH39foXSNoqoqdASYVBqtIaWEIZXTEqDcSnFsMCHSHDBJDjH0mXzoWiyLAVM1qv4FDX+luUIxDAOapkHb1Bh6hsvlnK2n3AZSNhPoYDwMWbaTgiTiRC76Dp4U8qnCXXnFY1vmuahJ4UCsC+U200FPllOegSyn/JLd1vy3bGcFJQVmNYKnPVLIVYnvTyfcX14gk2XGGOq6yvlNtDjSQVKYn0JA/RJzN/GAtxpPvx/w9cvnnGF6Sj81YILsyjPasUQxKWIdx6xwsRaWenpKUshdzE/hBLpQBIG+XF3PuL/7iXkUiDFAaAY+d+/1D61JWW1DjLFKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"home\"\n        title=\"home\"\n        src=\"/LeonardoMelo/static/89f58788be8e2c416677749e0fa4c10e/fcda8/iot_arq2.png\"\n        srcset=\"/LeonardoMelo/static/89f58788be8e2c416677749e0fa4c10e/12f09/iot_arq2.png 148w,\n/LeonardoMelo/static/89f58788be8e2c416677749e0fa4c10e/e4a3f/iot_arq2.png 295w,\n/LeonardoMelo/static/89f58788be8e2c416677749e0fa4c10e/fcda8/iot_arq2.png 590w,\n/LeonardoMelo/static/89f58788be8e2c416677749e0fa4c10e/efc66/iot_arq2.png 885w,\n/LeonardoMelo/static/89f58788be8e2c416677749e0fa4c10e/29229/iot_arq2.png 1167w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>The project is split into four relevant sections:</p>\n<ol>\n<li><strong>Hardware</strong>: a laser dust detection sensor, used for continuos and real-time detection of dust in the air was connected to a ESP32 board which includes a GPS sensor.</li>\n<li><strong>Network</strong>: the board communicates with the Low Powered Wide Area Network (LPWAN) <strong>LoRa</strong>, due to its range of 15Km (5km in urban scenarios) and low power consumption. Data from the device is received by the multiple public gateway available in <a href=\"https://www.thethingsnetwork.org/\">The Things Network</a>.</li>\n<li><strong>Backend</strong>: Information is sent from the TTN to our Node-Red backend, where the data is processed and displayed to the user.</li>\n<li><strong>Frontend</strong> a dashboard split into two views generic and detailed.</li>\n</ol>\n<h1>Dashboard</h1>\n<p>The generic dashboard allows the user to:</p>\n<ul>\n<li>Track the position of all the available devices through the map</li>\n<li>Observe the devices currently deployed and their metadata (Status, Name, Uptime, Position and Battery Level)</li>\n<li>An evolution of the multiple Particle Matters (PM) over the last 28 days (subtracting the average of the last 28 days with the average of the current day)</li>\n<li>The gauges display the Average, Minimum and Maximum values for the PM chosen over the period of days also selected by the user</li>\n<li>Lastly, line graphs that display the average values (Avg, Min, Max) for the last hour for all of the devices</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/LeonardoMelo/static/e6a1f43be35a55a9329a29b85af494e9/eee07/home.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACR0lEQVQozz2S324SQRTG923wwi67szP7b3YX2C1FjDHxzsQLY9VHMKmm98U2vkgNCaEl1gSwCYFWStlCgdIGS9/k8+w0enFyzszFb77vfKMdHx8jTVOcnZ2h1+thMBjg4uIC7XYbjUYDnU4Hh4eHcHwfpmWBmQyGTp1mk3PVGWPgNOu6Dm0w6GO9vsdqtcJ8PsdiscDd3S1Go5GCT6dTtFotFLa2wB0XMnRRemXA4ja8YlGBLIL+B56c/CTAPYHmuL6+ppoRZIbLyxH6/T7G4zGazSbCIIBlWnj+wcDLTznYwqE7CdM0YQhDQTc2NqAdHf3Azc0DQSZUKUGucHq6xGRyifPz38r+d7Lsk2XHduElBiljsBhXqpRC/qjQMAxo3W4XDw9rpW4yuSKbQwJd0U4H1M8xHA5Rr9chpURUiEiloB0yuK6rKlMouEBADpTCXwRcrf5guVyqfaXpmOBTzGYzdV7e3iJ7VIYSlUoFRdqbEBybm5tIkkQpKyQRqtWqmrXPu7s4ODhArVbD3t6e6rXaV+zTXVbf9vfxZWcHtu/A8z04FAwXNnxS7HvZLCBCDs/zYFLammE7ELat/Gfx/0ssk599iRwB/DhBHIUQLA+Xm3A4Q+jbKPpCnV3LhCcYTP0pNIdgBdpNtqNisUBWEpTLZZRKJTik4MnbbZTfbWOLLOYpCIvStUghswQYfR01U3EKTM9TKJmaKHoESumrHcVxDEmpZnZyr98gef8RL55VIAMPQehTOIHqAZ1l4CKMPJRiSU5N/AXL9LtZxkbQ+wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"home\"\n        title=\"home\"\n        src=\"/LeonardoMelo/static/e6a1f43be35a55a9329a29b85af494e9/fcda8/home.png\"\n        srcset=\"/LeonardoMelo/static/e6a1f43be35a55a9329a29b85af494e9/12f09/home.png 148w,\n/LeonardoMelo/static/e6a1f43be35a55a9329a29b85af494e9/e4a3f/home.png 295w,\n/LeonardoMelo/static/e6a1f43be35a55a9329a29b85af494e9/fcda8/home.png 590w,\n/LeonardoMelo/static/e6a1f43be35a55a9329a29b85af494e9/efc66/home.png 885w,\n/LeonardoMelo/static/e6a1f43be35a55a9329a29b85af494e9/c83ae/home.png 1180w,\n/LeonardoMelo/static/e6a1f43be35a55a9329a29b85af494e9/eee07/home.png 1628w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>It is also possible to keep up with the devices individually, allowing us too see:</p>\n<ul>\n<li>Path taken during operation</li>\n<li>Real time temperature levels</li>\n<li>Device metadata</li>\n<li>Real time measurements of the different particles tracked (PM 1.0, 2.5 and 10)</li>\n<li>All the information received for the particles during the last 24 hours, in 5 minute increments</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/LeonardoMelo/static/17f32b2c6d94acc038f7520ebe36e015/5c263/detailed.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.621621621621614%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACFUlEQVQozz1Sy27aUBD13yTiYWxjYxvb2MQgFGXdVgJKYNNWqtJFV2XTZwRqhRq1/4JASEhRaVGElEWl8H4nlGbBjg84nXvVdnE0d8aaM2fmWHhYOMXjQgEFQrFY5O98Po9sNotcLodSqcSjaZrQdR2xWAyapkFVVf6WJAnRaJR/C4bDEL5dXmI+n3MsFgusCOvVCsvlEtPplNebzSZvsuJx3mhZFh/gui7iVItpKjTLxqFhQuh2u9jtdpxsNpthcnODOUVGtF6vOer1OleSyWRgGAZkSYbvp+B5HhRFgWMnkE6nEQqFIHQ6Hd7E1EwmE0wHAwwJ4/EYK1K63W7RaDS4It/34TgOdFOHd+TBTbjQdBWJjAM/6dMgCUK73Ua/38doNMKQ8PPqCnMiHwyHXDEb1mq1uEJ2N1lWaEUNlm3DoHXZKWRFgmFbEGUi7PV62Gw2XM3v+3uMr6/x6+4Ot7e3GNOA/X6PH53v0KnBcGwotC4jYeQqux0ZEz4IoPjpNU6enkIol8uoVCr/8fniArVaDR/Oz/H23XtUq1W8ODuD7Xrwj49hkiEGc5xuqf11OnR4gJcfv+DBk+cQ2N6yKCJClkthERodWSXwnOpKJAKRYip5hAwZwd0lMxg8qvmpFFRDx9dXb/DsUR4Cs5459w/stzAIJlNA00+oIWk73EGRhgQpBgIBBINBhChn9TCJSpJyhfI/p4KWJ3bGb5IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"detailed\"\n        title=\"detailed\"\n        src=\"/LeonardoMelo/static/17f32b2c6d94acc038f7520ebe36e015/fcda8/detailed.png\"\n        srcset=\"/LeonardoMelo/static/17f32b2c6d94acc038f7520ebe36e015/12f09/detailed.png 148w,\n/LeonardoMelo/static/17f32b2c6d94acc038f7520ebe36e015/e4a3f/detailed.png 295w,\n/LeonardoMelo/static/17f32b2c6d94acc038f7520ebe36e015/fcda8/detailed.png 590w,\n/LeonardoMelo/static/17f32b2c6d94acc038f7520ebe36e015/efc66/detailed.png 885w,\n/LeonardoMelo/static/17f32b2c6d94acc038f7520ebe36e015/c83ae/detailed.png 1180w,\n/LeonardoMelo/static/17f32b2c6d94acc038f7520ebe36e015/5c263/detailed.png 1636w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h1>Dashboard updates</h1>\n<p>Each dashboard is updated in a different manner. The home dashboard, which includes only aggregated information over multiple days does not require real time information, as such, data is updated through Polling with a periodicity of 1 hour or every time the user refreshes the page.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/LeonardoMelo/static/321b159198a8c074c420f5aa633e5c6c/f8c2f/coms.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.94594594594595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA3UlEQVQoz3WQ2QqDMBBF8/9/KCgKKtZ9qca4xPbUwVCovQ8hmcxdZtTrD/Z9P45jGIYwDIMgKMty2zZrLUW+5K5+aXwvy9K2bdd1cLIs4xxOVFXV932SJE3TrOuqbj3neRYVrTUOUoSACid8z/NIpOiQMI7ME2e54/a4IINIZ13X4zgqfQKr7cTzBIGnaZJumRB8GwgUGYSPEoQ8zzFJ05TxmOp2l07lE9sYg/BvbGniLilcAxV0+b1ZGGS6UaSJEWTV7MlciOO4KAomVbfB7AUMmQs+HFdE2vf9KIreMRcLvcH+WhkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"coms\"\n        title=\"coms\"\n        src=\"/LeonardoMelo/static/321b159198a8c074c420f5aa633e5c6c/fcda8/coms.png\"\n        srcset=\"/LeonardoMelo/static/321b159198a8c074c420f5aa633e5c6c/12f09/coms.png 148w,\n/LeonardoMelo/static/321b159198a8c074c420f5aa633e5c6c/e4a3f/coms.png 295w,\n/LeonardoMelo/static/321b159198a8c074c420f5aa633e5c6c/fcda8/coms.png 590w,\n/LeonardoMelo/static/321b159198a8c074c420f5aa633e5c6c/efc66/coms.png 885w,\n/LeonardoMelo/static/321b159198a8c074c420f5aa633e5c6c/c83ae/coms.png 1180w,\n/LeonardoMelo/static/321b159198a8c074c420f5aa633e5c6c/f8c2f/coms.png 2701w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>On the other hand, as the user requires real time information when tracking individual devices a Publish/Subscribe broker was introduced, this way every time new information is received from the gateways a notification is sent to the dashboards and data is updated in realtime.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/LeonardoMelo/static/4e44c7cd3ce5bc073d2f1ebcf8512447/8733b/pubsub.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA8UlEQVQoz3WRyRKDMAxD8/8fCQcGCPsa1kL7QDSXTn3wiFiKFGOWZUnTNIqivu/fP3We5/KtYRiKorDWhmEYx/E4jmbbNhivu9DD2Pcd6rqu9Hme6RCO46BP0+Scg0NndImrqsrzvG3bruvqugYzKMuSW+hgLxOTmDjzaWAwkCHmRMVTJ8gAKBmBGclWAR8xkRDQwTAAkjHWCR02jyQXWbIswx/CFZsjNsGsaRoAM1YIEA9Sdxe3cAUcMG98FoYPiMVoDWB3F0Cx4SgnhvauJEnQGwKTirF/s/9JHmv/ckbjuxFP9f5TiBWHbfPGIAj0nA+akwXt0tcNAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pubsub\"\n        title=\"pubsub\"\n        src=\"/LeonardoMelo/static/4e44c7cd3ce5bc073d2f1ebcf8512447/fcda8/pubsub.png\"\n        srcset=\"/LeonardoMelo/static/4e44c7cd3ce5bc073d2f1ebcf8512447/12f09/pubsub.png 148w,\n/LeonardoMelo/static/4e44c7cd3ce5bc073d2f1ebcf8512447/e4a3f/pubsub.png 295w,\n/LeonardoMelo/static/4e44c7cd3ce5bc073d2f1ebcf8512447/fcda8/pubsub.png 590w,\n/LeonardoMelo/static/4e44c7cd3ce5bc073d2f1ebcf8512447/efc66/pubsub.png 885w,\n/LeonardoMelo/static/4e44c7cd3ce5bc073d2f1ebcf8512447/c83ae/pubsub.png 1180w,\n/LeonardoMelo/static/4e44c7cd3ce5bc073d2f1ebcf8512447/8733b/pubsub.png 1495w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>A subscription was created for the device, that notifies every time something changers such as battery level or location. And a second subscription dedicated to the air quality observed.</p>","frontmatter":{"title":"Air Quality Monitoring","date":"May 06, 2020","description":"Dashboard that tracks the Lisbon (Portugal) air quality. Data is collected through a moving TTGO ESP32 device that communicates via LoRa with an API built in NodeRed.","time":null,"stack":["MicroPy","Orion","NodeRed","ESP32"]}}},"pageContext":{"slug":"/air-quality/"}},"staticQueryHashes":["3649515864","63159454"]}